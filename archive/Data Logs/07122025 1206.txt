(venv) jay@RoboPi:~/rover_project $ python3 bluetooth_optimized_navigator_v6_corrected.py
âœ… Bluetooth (bleak) library available
================================================================================
ğŸ¤– BLUETOOTH OPTIMIZED NAVIGATOR V6
================================================================================

OPTIMIZED TRACKING FEATURES:
  âœ… Ultrasonic obstacle detection and avoidance
  âœ… Enhanced stuck recovery system
  âœ… Arduino gatekeeper integration
  âœ… Real-time Bluetooth beacon ranging (0.8m - 30m)
  âœ… Working RSSI values with balanced noise reduction
  âœ… Thread-safe callback-based BLE scanning
  ğŸš¶ PROVEN: Forward movement signal strength tracking
  ğŸ”„ PROVEN: Turn-and-test behavior for course corrections
  ğŸ§  BALANCED: Smart obstacle avoidance without over-turning
  ğŸ“Š OPTIMIZED: RSSI smoothing for stability without over-filtering
  â±ï¸ ENHANCED: Longer movement phases for effective gradient detection
  ğŸ¯ PROVEN: Precise target hold at 0.5m Â±0.15m
  âœ… Safety-first design with ultrasonic priority
  âœ… Clean shutdown with no task warnings

OPTIMIZED NAVIGATION BEHAVIOR:
  ğŸ” SEARCHING: Look for BlueCharm signal
  ğŸš¶ FORWARD_TRACKING: Extended movement (8s) while monitoring signal
  ğŸ”„ TURN_TESTING: Test left/right turns when signal degrades
  ğŸ§  SMART_AVOIDING: Balanced turning until path is clear
  ğŸ¯ APPROACHING: Gentle approach to target
  ğŸ HOLDING: Maintain precise 0.5m distance
  ğŸ›¡ï¸ SAFETY: Ultrasonic overrides all Bluetooth behavior

KEY OPTIMIZATIONS:
  ğŸ“ Tracking range: <15m (vs 3m) for real-world signal detection
  â±ï¸ Movement phases: 3s tracking (vs 8s) for faster response + wrong direction detection
  ğŸ“Š RSSI smoothing: 50% new data (vs 30%) for responsiveness
  ğŸ¯ Signal thresholds: 1.5dBm improvement | 4dBm degradation
  ğŸ§  Smart turning: 0.6s precise turns | Clear at >90cm + wrong direction detection
  â±ï¸ Exploration: 10s intervals for fewer interruptions

ğŸš€ Bluetooth Optimized Navigator V6 Final - Indoor/Outdoor Power Modes
ğŸ“Š Navigation: Danger=30.0cm | Caution=60.0cm | Safe=100.0cm
ğŸ“¡ Bluetooth: Enabled | Target: DD:34:02:09:CA:1E
ğŸš¶ Tracking: Target distance 0.5m Â±0.15m | Influence 35%
ğŸ“ˆ Signal: 1.0dBm improvement | 2.0dBm degradation triggers
ğŸ“ Ranges: Tracking <15.0m | Approach <1.2m | Target 0.5m
â±ï¸ Timing: 3.0s tracking phases | 10.0s exploration
ğŸ§  Smart Turn: Clear >90.0cm | 1.0-3.5s
ğŸ“Š Smoothing: 50% new RSSI | 60% new distance | >3.0x outlier threshold
ğŸ  POWER MODE: INDOOR mode active (RC switch toggles modes)
âš¡ MOTOR SPEEDS: 100/85/80 (indoor power)
ğŸ¯ NAVIGATION FIXES: Wrong direction detection + 0.6s precise turns
ğŸš€ FAST RESPONSE: 3.0s tracking + 2.0m course correction threshold
ğŸ› HOLDING BUG FIX: Will detect BlueCharm movement >10dBm RSSI change
ğŸ”„ RC SWITCH: Toggle power mode using RC transmitter (defaults to INDOOR)
ğŸ›¡ï¸ Safety: Ultrasonic navigation takes absolute priority
âœ… Arduino connected on /dev/ttyUSB0
ğŸ“¡ Starting BlueCharm optimized tracking thread...
ğŸ“¡ BlueCharm optimized tracking scanner started
ğŸ“¡ BlueCharm optimized tracking scanner ready
ğŸš€ Optimized Navigator V6 started
ğŸ¯ Ready for effective signal gradient tracking with longer movement phases
âœ… Optimized Navigator V6 ready - switch to autonomous mode
ğŸ“¡ BlueCharm optimized tracking will activate automatically
ğŸ¯ Rover will use longer movement phases for effective signal tracking
ğŸ“Š Balanced smoothing will provide stability without over-filtering
Press Ctrl+C to stop...
ğŸ“¡ Starting BLE optimized tracking scanner...
ğŸ“¡ BLE optimized tracking scanner active
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: No signal | Det: 0 | Runtime: 7s
ğŸ“¡ Stopping BLE optimized tracking scanner...

ğŸ”„ POWER MODE CHANGED: INDOOR â†’ OUTDOOR
âš¡ NEW MOTOR SPEEDS: 255/220/240
ğŸŒ± OUTDOOR MODE: Maximum power for grass navigation

ğŸ”„ SEARCH PATTERN: Looking for signal...
ğŸ“¡ Starting BLE optimized tracking scanner...
ğŸ“¡ BLE optimized tracking scanner active
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: No signal | Det: 0 | Runtime: 16s

ğŸ”„ POWER MODE CHANGED: OUTDOOR â†’ INDOOR
âš¡ NEW MOTOR SPEEDS: 100/85/80
ğŸ  INDOOR MODE: Reduced power for smooth surfaces

ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: 17.8m (-84dBm PASS) | Det: 1 | Runtime: 19s
ğŸš¶ TRACKING MODE: BlueCharm at 10.9m - forward tracking activated
ğŸ§  SMART AVOIDING! Obstacle at 28.0cm - turning left until clear
âœ… SMART CLEAR: Path clear at 200.0cm after 1.0s turn - resuming forward_tracking
ğŸ TRACKING INITIALIZED: Starting at 7.7m
ğŸš¶ EXTENDED TRACKING: 10.4m signal stable (t=0.5s)
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 8.7m (-74dBm TRACKâ†—) | Det: 4 | Runtime: 22s
ğŸ§  SMART AVOIDING! Obstacle at 15.1cm - turning right until clear
ğŸ“¡ BlueCharm TRACKINGâ†— #5:
   RSSI: -76dBm (raw: -76) | Distance: ~8.1m | Avg: -77dBm
âœ… SMART CLEAR: Path clear at 200.0cm after 1.5s turn - resuming forward_tracking
ğŸš¶ EXTENDED TRACKING: 8.1m signal â†—improving (t=0.5s)
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 8.1m (-76dBm TRACKâ†—) | Det: 5 | Runtime: 25s
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 6.4m (-74dBm TRACKâ†—) | Det: 7 | Runtime: 28s
ğŸ“¡ Stopping BLE optimized tracking scanner...
ğŸ“¡ Starting BLE optimized tracking scanner...
ğŸ“¡ BLE optimized tracking scanner active
ğŸ“¡ Signal timeout (13.0s) - ending all tracking modes
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: No signal | Det: 7 | Runtime: 42s
ğŸš¶ TRACKING MODE: BlueCharm at 7.5m - forward tracking activated
ğŸ“¡ BlueCharm TRACKING #10:
   RSSI: -75dBm (raw: -76) | Distance: ~6.5m | Avg: -75dBm
ğŸ§  SMART AVOIDING! Obstacle at 28.6cm - turning left until clear
ğŸ§­ AUTONOMOUS | SMART_AVOIDINGğŸ§  | US: 28.6cm | BT: 6.5m (-75dBm TRACK) | Det: 10 | Runtime: 45s
âœ… SMART CLEAR: Path clear at 200.0cm after 1.0s turn - resuming forward_tracking
ğŸš¶ EXTENDED TRACKING: 5.2m signal stable (t=0.5s)
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.2m (-72dBm TRACK) | Det: 11 | Runtime: 48s
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 4.4m (-70dBm TRACKâ†—) | Det: 12 | Runtime: 51s
ğŸ§  SMART AVOIDING! Obstacle at 7.9cm - turning right until clear
âœ… SMART CLEAR: Path clear at 200.0cm after 1.0s turn - resuming forward_tracking
ğŸš¶ EXTENDED TRACKING: 4.4m signal â†—improving (t=0.5s)
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.2m (-73dBm TRACKâ†—) | Det: 13 | Runtime: 54s
ğŸ“¡ BlueCharm TRACKINGâ†— #15:
   RSSI: -74dBm (raw: -76) | Distance: ~5.3m | Avg: -73dBm
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.3m (-74dBm TRACKâ†—) | Det: 15 | Runtime: 57s
ğŸš¶ EXTENDED TRACKING: 5.3m signal â†—improving (t=6.0s)
ğŸš¶ EXTENDED TRACKING: 5.3m signal â†—improving (t=6.5s)
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.3m (-74dBm TRACKâ†—) | Det: 15 | Runtime: 60s
ğŸ“Š === Optimized Navigator V6 Statistics ===
   Runtime: 60 seconds
   Distance measurements: 355
   Obstacle avoidances: 4
   Emergency stops: 53
   Stuck recoveries: 0
ğŸ¯ === Optimized Navigation Statistics ===
   Smart turns: 4
   Tracking activations: 2
   Approach activations: 0
   Hold activations: 0
   Target reaches: 0
   Signal improvements: 2
   Course corrections: 0
   Turn tests: 0
   Long tracking phases: 0
ğŸ“Š === Optimized RSSI Statistics ===
   Outliers rejected: 0
ğŸ“¡ === Bluetooth Ranging Statistics ===
   Total detections: 15
   Callback events: 15
   Detection rate: 0.25/sec
   Callback rate: 0.25/sec
   Strongest RSSI: -69.66544394175017 dBm
   Signal timeouts: 1
   Average RSSI: -73.3 dBm
   Average smoothed distance: 5.2m
   Current modes: TRACKING
   Navigation rate: 5.9 measurements/sec
ğŸ”„ SIGNAL DEGRADING: Testing left turn after 8.0s tracking
ğŸ”„ TESTING: left turn for signal improvement
ğŸ”„ TRYING RIGHT: Left turn didn't help, testing right
ğŸ§  SMART AVOIDING! Obstacle at 11.5cm - turning left until clear
âœ… SMART CLEAR: Path clear at 200.0cm after 1.0s turn - resuming forward_tracking
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.7m (-75dBm TRACKâ†˜) | Det: 16 | Runtime: 63s
ğŸ TRACKING INITIALIZED: Starting at 5.5m
ğŸš¶ EXTENDED TRACKING: 5.4m signal â†˜degrading (t=0.5s)
ğŸ§  SMART AVOIDING! Obstacle at 8.2cm - turning right until clear
ğŸ§­ AUTONOMOUS | SMART_AVOIDINGğŸ§  | US: 3.5cm | BT: 5.4m (-74dBm TRACKâ†˜) | Det: 17 | Runtime: 66s
âœ… SMART CLEAR: Path clear at 200.0cm after 1.5s turn - resuming forward_tracking
ğŸš¶ EXTENDED TRACKING: 5.6m signal â†˜degrading (t=0.5s)
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.6m (-74dBm TRACKâ†˜) | Det: 18 | Runtime: 69s
ğŸ”„ SIGNAL DEGRADING: Testing left turn after 3.0s tracking
ğŸ”„ TESTING: left turn for signal improvement
ğŸ“¡ BlueCharm TRACKINGâ†˜ #20:
   RSSI: -74dBm (raw: -74) | Distance: ~5.6m | Avg: -74dBm
ğŸ”„ TRYING RIGHT: Left turn didn't help, testing right
ğŸ”„ TESTING: right turn for signal improvement
âš ï¸ NO IMPROVEMENT: Continuing forward tracking
ğŸ§­ AUTONOMOUS | FORWARD_TRACKING | US: 200.0cm | BT: 5.6m (-74dBm TRACKâ†˜) | Det: 20 | Runtime: 72s
ğŸ TRACKING INITIALIZED: Starting at 5.6m
ğŸš¶ EXTENDED TRACKING: 5.6m signal â†˜degrading (t=0.5s)
ğŸš¨ WRONG DIRECTION: Distance increased 7.0m (5.6m â†’ 12.6m)
ğŸ”„ IMMEDIATE COURSE CORRECTION: Turning around to find BlueCharm
ğŸ”„ TESTING: left turn for signal improvement
ğŸ”„ TRYING RIGHT: Left turn didn't help, testing right
ğŸ§­ AUTONOMOUS | TURN_TESTING | US: 200.0cm | BT: 9.8m (-81dBm TRACKâ†˜) | Det: 21 | Runtime: 75s
ğŸ”„ TESTING: right turn for signal improvement
âš ï¸ NO IMPROVEMENT: Continuing forward tracking
ğŸ TRACKING INITIALIZED: Starting at 12.6m
ğŸš¶ EXTENDED TRACKING: 9.8m signal â†˜degrading (t=0.5s)
ğŸ“¡ Stopping BLE optimized tracking scanner...
ğŸ”„ SIGNAL DEGRADING: Testing left turn after 15.0s tracking
^C
ğŸ›‘ Shutdown requested by user...
ğŸ›‘ Stopping Optimized Navigator V6...
ğŸ“Š Final runtime: 113.4 seconds
ğŸ“Š === Optimized Navigator V6 Statistics ===
   Runtime: 113 seconds
   Distance measurements: 636
   Obstacle avoidances: 6
   Emergency stops: 250
   Stuck recoveries: 0
ğŸ¯ === Optimized Navigation Statistics ===
   Smart turns: 6
   Tracking activations: 2
   Approach activations: 0
   Hold activations: 0
   Target reaches: 0
   Signal improvements: 2
   Course corrections: 4
   Turn tests: 5
   Long tracking phases: 3
ğŸ“Š === Optimized RSSI Statistics ===
   Outliers rejected: 0
ğŸ“¡ === Bluetooth Ranging Statistics ===
   Total detections: 21
   Callback events: 21
   Detection rate: 0.19/sec
   Callback rate: 0.19/sec
   Strongest RSSI: -69.66544394175017 dBm
   Signal timeouts: 1
   Average RSSI: -74.8 dBm
   Average smoothed distance: 6.3m
   Current modes: TRACKING
   Navigation rate: 5.6 measurements/sec
ğŸ‘‹ Optimized Navigator V6 shutdown complete
(venv) jay@RoboPi:~/rover_project $
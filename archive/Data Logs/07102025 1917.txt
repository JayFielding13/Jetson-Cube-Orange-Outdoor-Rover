(venv) jay@RoboPi:~/rover_project $ nano bluetooth_gradient_navigator_v3.py
(venv) jay@RoboPi:~/rover_project $ (venv) jay@RoboPi:~/rover_project $ python3 bluetooth_gradient_navigator_v3.py
âœ… Bluetooth (bleak) library available
================================================================================
ğŸ¤– BLUETOOTH GRADIENT NAVIGATOR V3
================================================================================

SIGNAL STRENGTH GRADIENT FEATURES:
  âœ… Ultrasonic obstacle detection and avoidance
  âœ… Enhanced stuck recovery system
  âœ… Arduino gatekeeper integration
  âœ… Real-time Bluetooth beacon ranging (0.8m - 11.2m)
  âœ… Working RSSI values (-57dBm to -80dBm)
  âœ… Thread-safe callback-based BLE scanning
  ğŸ§­ NEW: Signal strength gradient following
  ğŸ”„ NEW: Circular scanning for directional detection
  ğŸ¯ NEW: Intelligent homing toward strongest signal
  ğŸ NEW: Precise target hold at 0.5m Â±0.1m
  ğŸ“Š NEW: RSSI hill climbing algorithm
  âœ… Safety-first design with ultrasonic priority
  âœ… Clean shutdown with no task warnings

GRADIENT FOLLOWING BEHAVIOR:
  ğŸ” SEARCHING: Look for BlueCharm signal
  ğŸ”„ SCANNING: Circular scan to find strongest direction
  ğŸ  HOMING: Move toward strongest signal direction
  ğŸ HOLDING: Maintain precise 0.5m distance
  ğŸ›¡ï¸ SAFETY: Ultrasonic overrides all Bluetooth behavior

SCANNING ALGORITHM:
  ğŸ§­ 360Â° scan in 8 direction samples
  ğŸ“Š 3dBm improvement threshold for direction change
  ğŸ¯ Target: 0.5m Â±0.1m with adaptive approach speeds

ğŸš€ Bluetooth Gradient Navigator V3 Initialized
ğŸ“Š Navigation: Danger=30.0cm | Caution=60.0cm | Safe=100.0cm
ğŸ“¡ Bluetooth: Enabled | Target: DD:34:02:09:CA:1E
ğŸ§­ Gradient: Target distance 0.5m Â±0.1m | Influence 40%
ğŸ”„ Scanning: 8 directions | 3dBm improvement threshold
ğŸ›¡ï¸ Safety: Ultrasonic navigation takes absolute priority
âœ… Arduino connected on /dev/ttyUSB0
ğŸ“¡ Starting BlueCharm gradient thread...
ğŸ“¡ BlueCharm gradient scanner started
ğŸ“¡ BlueCharm gradient scanner ready
ğŸš€ Gradient Navigator V3 started
ğŸ§­ Ready for autonomous signal strength gradient following
âœ… Gradient Navigator V3 ready - switch to autonomous mode
ğŸ“¡ BlueCharm gradient following will activate automatically
ğŸ§­ Rover will scan, home, and hold at 0.5m distance
Press Ctrl+C to stop...
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: No signal | Det: 0 | Runtime: 3s
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ”„ SEARCH PATTERN: Looking for signal...
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: No signal | Det: 0 | Runtime: 6s
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: 3.5m (-70dBm PASS) | Det: 2 | Runtime: 9s
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ”„ SCANNING MODE: BlueCharm at 2.5m - finding direction
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (2.5m)
ğŸ”„ SCANNING: 30Â° (0 samples)
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 5.6m (-74dBm SCAN@90Â°) | Det: 4 | Runtime: 12s
ğŸ”„ SCANNING: 120Â° (1 samples)
ğŸ”„ SCANNING: 150Â° (1 samples)
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ”„ SCANNING: 240Â° (1 samples)
ğŸ“¡ BlueCharm SCAN@240Â° #5:
   RSSI: -66dBm | Distance: ~2.2m | Avg: -70dBm
ğŸ”„ SCANNING: 270Â° (2 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.2m (-66dBm SCAN@270Â°) | Det: 5 | Runtime: 15s
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ SCAN ANALYSIS: 3 samples
   Best direction: 300Â° with -65dBm (2.0m)
ğŸ§­ SCAN COMPLETE: Homing toward 300Â° direction
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
âš ï¸ Unknown navigation state - defaulting to search
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (2.0m)
ğŸ”„ SCANNING: 30Â° (1 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@30Â°) | Dir: 300Â° | Det: 7 | Runtime:  18s
ğŸ”„ SCANNING: 120Â° (2 samples)
ğŸ”„ SCANNING: 150Â° (2 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.2m (-66dBm SCAN@210Â°) | Dir: 300Â° | Det: 8 | Runtime:  21s
ğŸ”„ SCANNING: 240Â° (2 samples)
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ”„ SCANNING: 270Â° (2 samples)
ğŸ”„ SCAN INCONCLUSIVE: Continuing search
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (2.0m)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@330Â°) | Dir: 300Â° | Det: 9 | Runtime:  24s
ğŸ”„ SCANNING: 30Â° (3 samples)
ğŸ“¡ BlueCharm SCAN@30Â° #10:
   RSSI: -64dBm | Distance: ~1.8m | Avg: -68dBm
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ”„ SCANNING: 120Â° (4 samples)
ğŸ”„ SCANNING: 150Â° (4 samples)
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@180Â°) | Dir: 300Â° | Det: 11 | Runtime : 27s
ğŸ”„ SCANNING: 240Â° (6 samples)
ğŸ”„ SCANNING: 270Â° (6 samples)
ğŸ§­ SCAN ANALYSIS: 7 samples
   Best direction: 30Â° with -64dBm (1.8m)
ğŸ§­ SCAN COMPLETE: Homing toward 30Â° direction
ğŸ§­ AUTONOMOUS | HOMING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@330Â°) | Dir: 30Â° | Det: 13 | Runtime: 3 0s
âš ï¸ Unknown navigation state - defaulting to search
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (2.0m)
ğŸ”„ SCANNING: 30Â° (1 samples)
ğŸ“¡ BlueCharm SCAN@60Â° #15:
   RSSI: -65dBm | Distance: ~2.0m | Avg: -67dBm
ğŸ”„ SCANNING: 120Â° (2 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@120Â°) | Dir: 30Â° | Det: 15 | Runtime:  33s
ğŸ”„ SCANNING: 150Â° (3 samples)
ğŸ”„ SCANNING: 240Â° (4 samples)
ğŸ”„ SCANNING: 270Â° (4 samples)
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@300Â°) | Dir: 30Â° | Det: 17 | Runtime:  36s
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
ğŸ§­ SCAN ANALYSIS: 4 samples
   Best direction: 330Â° with -64dBm (1.8m)
ğŸ§­ SCAN COMPLETE: Homing toward 330Â° direction
âš ï¸ Unknown navigation state - defaulting to search
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (2.0m)
ğŸ”„ SCANNING: 30Â° (1 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.0m (-65dBm SCAN@60Â°) | Dir: 330Â° | Det: 18 | Runtime:  39s
ğŸ“¡ BlueCharm SCAN@90Â° #20:
   RSSI: -65dBm | Distance: ~2.0m | Avg: -66dBm
ğŸ“¡ Stopping BLE gradient scanner...
ğŸ§­ SCAN ANALYSIS: 3 samples
   Best direction: 330Â° with -65dBm (2.0m)
ğŸ§­ SCAN COMPLETE: Homing toward 330Â° direction
ğŸ“¡ Starting BLE gradient scanner...
ğŸ“¡ BLE gradient scanner active
âš ï¸ Unknown navigation state - defaulting to search
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (2.5m)
ğŸ”„ SCANNING: 30Â° (1 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 2.5m (-67dBm SCAN@30Â°) | Dir: 330Â° | Det: 21 | Runtime:  48s
ğŸ”„ SCANNING: 120Â° (2 samples)
ğŸ”„ SCANNING: 150Â° (2 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 5.0m (-73dBm SCAN@210Â°) | Dir: 330Â° | Det: 23 | Runtime : 51s
ğŸ”„ SCANNING: 240Â° (3 samples)
ğŸ”„ SCANNING: 270Â° (4 samples)
ğŸ“¡ BlueCharm SCAN@300Â° #25:
   RSSI: -71dBm | Distance: ~4.0m | Avg: -66dBm
ğŸ§­ SCAN ANALYSIS: 5 samples
   Best direction: 90Â° with -67dBm (2.5m)
ğŸ§­ SCAN COMPLETE: Homing toward 90Â° direction
âš ï¸ Unknown navigation state - defaulting to search
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: 1.4m (-62dBm SCAN@330Â°) | Dir: 90Â° | Det: 26 | Runtime : 54s
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (1.4m)
ğŸ”„ SCANNING: 30Â° (2 samples)
ğŸ”„ SCANNING: 120Â° (3 samples)
ğŸ”„ SCANNING: 150Â° (4 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 4.0m (-71dBm SCAN@150Â°) | Dir: 90Â° | Det: 29 | Runtime:  57s
ğŸ“¡ BlueCharm SCAN@180Â° #30:
   RSSI: -68dBm | Distance: ~2.8m | Avg: -67dBm
ğŸ”„ SCANNING: 240Â° (5 samples)
ğŸ”„ SCANNING: 270Â° (6 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 1.4m (-62dBm SCAN@330Â°) | Dir: 90Â° | Det: 32 | Runtime:  60s
ğŸ§­ SCAN ANALYSIS: 7 samples
   Best direction: 330Â° with -62dBm (1.4m)
ğŸ§­ SCAN COMPLETE: Homing toward 330Â° direction
âš ï¸ Unknown navigation state - defaulting to search
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (4.5m)
ğŸ”„ SCANNING: 30Â° (2 samples)
ğŸ“¡ BlueCharm SCAN@60Â° #35:
   RSSI: -71dBm | Distance: ~4.0m | Avg: -67dBm
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 4.0m (-71dBm SCAN@90Â°) | Dir: 330Â° | Det: 35 | Runtime:  63s
ğŸ”„ SCANNING: 120Â° (3 samples)
ğŸ”„ SCANNING: 150Â° (4 samples)
ğŸ”„ SCANNING: 240Â° (5 samples)
ğŸ”„ SCANNING: 270Â° (6 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 1.4m (-62dBm SCAN@270Â°) | Dir: 330Â° | Det: 38 | Runtime : 66s
ğŸ§­ SCAN ANALYSIS: 7 samples
   Best direction: 330Â° with -62dBm (1.4m)
ğŸ§­ SCAN COMPLETE: Homing toward 330Â° direction
ğŸ“¡ BlueCharm SCAN@330Â° #40:
   RSSI: -63dBm | Distance: ~1.6m | Avg: -68dBm
âš ï¸ Unknown navigation state - defaulting to search
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (1.6m)
ğŸ”„ SCANNING: 30Â° (2 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 3.2m (-69dBm SCAN@30Â°) | Dir: 330Â° | Det: 41 | Runtime:  69s
ğŸ”„ SCANNING: 120Â° (3 samples)
ğŸ”„ SCANNING: 150Â° (3 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 4.5m (-72dBm SCAN@210Â°) | Dir: 330Â° | Det: 43 | Runtime : 72s
ğŸ”„ SCANNING: 240Â° (5 samples)
ğŸ”„ SCANNING: 270Â° (5 samples)
ğŸ“¡ BlueCharm SCAN@270Â° #45:
   RSSI: -69dBm | Distance: ~3.2m | Avg: -68dBm
ğŸ§­ SCAN ANALYSIS: 7 samples
   Best direction: 330Â° with -63dBm (1.6m)
ğŸ§­ SCAN COMPLETE: Homing toward 330Â° direction
âš ï¸ Unknown navigation state - defaulting to search
ğŸ§­ AUTONOMOUS | SEARCHING | US: 200.0cm | BT: 4.0m (-71dBm SCAN@330Â°) | Dir: 330Â° | Det: 46 | Runtim e: 75s
ğŸ“¡ SIGNAL DETECTED: Switching to scanning mode (1.4m)
ğŸ”„ SCANNING: 30Â° (1 samples)
ğŸ”„ SCANNING: 120Â° (3 samples)
ğŸ”„ SCANNING: 150Â° (3 samples)
ğŸ§­ AUTONOMOUS | SCANNING | US: 200.0cm | BT: 1.4m (-62dBm SCAN@150Â°) | Dir: 330Â° | Det: 49 | Runtime : 78s
ğŸ“¡ Stopping BLE gradient scanner...
^C
ğŸ›‘ Shutdown requested by user...
ğŸ›‘ Stopping Gradient Navigator V3...
ğŸ“Š Final runtime: 81.7 seconds
ğŸ“Š === Gradient Navigator V3 Statistics ===
   Runtime: 82 seconds
   Distance measurements: 520
   Obstacle avoidances: 0
   Emergency stops: 0
   Stuck recoveries: 0
ğŸ§­ === Signal Strength Gradient Statistics ===
   Scan activations: 1
   Homing activations: 0
   Hold activations: 0
   Target reaches: 0
   Gradient improvements: 3
   Direction changes: 8
ğŸ“¡ === Bluetooth Ranging Statistics ===
   Total detections: 49
   Callback events: 49
   Detection rate: 0.60/sec
   Callback rate: 0.60/sec
   Strongest RSSI: -62 dBm
   Signal timeouts: 0
   Average RSSI: -67.5 dBm
   Current modes: SCANNING
   Best direction: 330Â°
   Navigation rate: 6.4 measurements/sec
ğŸ‘‹ Gradient Navigator V3 shutdown complete
(venv) jay@RoboPi:~/rover_project $